!function(e){e(document).ready(function(){"use strict";let t,s,o,i=e(".js-menu-item"),n=e(".js-sidebar-menu"),a=e(".js-icon-list"),r=e(".js-sidebar-menu-content"),l=e(".js-home-loading"),c=30,d=!1,h=e(".js-speech-btn"),m="",f="",u=!1,p=!0;"speechSynthesis"in window&&window.speechSynthesis.cancel();const w=new ColorThief;cssVars();let g=e("title"),v=g.text();e(window).blur(function(){g.text("Geschichte wartet . – history.first"),setTimeout(function(){g.text("Geschichte wartet .. – history.first")},1e3),setTimeout(function(){g.text("Geschichte wartet ... – history.first")},2e3)}),e(window).focus(function(){g.text(v)});let b=.01*window.innerHeight;if(document.documentElement.style.setProperty("--vh",b+"px"),e(window).load(function(){t=e(".home-topic").first().height(),s=e(window).height()-t,o=3*t+s,e(".red-ribbon").css("height",o)}),window.matchMedia("(max-width: 575px)").matches&&(c=15),l.length)if(sessionStorage.getItem("loaded"))l.hide(),x();else{var j=!1;e(window).load(function(){j=!0,sessionStorage.setItem("loaded","true")}),e(".js-slogan").each(function(){e(this).hide().html("Geschichte<br>laden").fadeIn(1e3);var t=new ProgressBar.Circle(".js-progress-circle",{strokeWidth:1,duration:2e3,color:"#FFF",trailColor:"#eee",trailWidth:.4,svgStyle:null});t.animate(1),function e(){setTimeout(function(){t.set(0),j?(t.destroy(),l.fadeOut("slow"),x()):(t.animate(1),e())},2e3)}()})}function C(){let t=e(".js-aside");t.length&&(t.offset().top+t.height()>=t.offset().top-10&&t.addClass("fixed"),e(document).scrollTop()+window.innerHeight<e(".js-footer").offset().top&&t.removeClass("fixed"))}function x(){e(".js-slogan").each(function(){let s=e(this),i=parseInt(s.data("max")),n=2;if(sessionStorage.getItem("loaded")){let e=s.data("word1");s.hide().html(e).fadeIn(1e3),setTimeout(function(){s.addClass("out")},4500)}var a=new ProgressBar.Circle(".js-progress-circle",{strokeWidth:1,duration:5e3,color:"#FFF",trailColor:"#eee",trailWidth:.4,svgStyle:null});a.animate(1),setInterval(function(){let e=s.data("word"+n),r=n-1;0===r&&(r=i);let l=n;1===l&&y(0),2===l&&y(o/2-t/2+c),3===l&&y(o-t+2*c),s.hide().html(e).show().addClass("in").removeClass("out"),setTimeout(function(){s.removeClass("in").addClass("out")},4500),n<i?n++:n=1,a.set(0),a.animate(1)},5e3)})}function y(t){e(".js-ribbon").each(function(){let s=e(this),o=parseFloat(t);s.hasClass("red-ribbon--right")&&(o=-1*parseFloat(t)),s.css("transform","translateY("+o+"px)")})}e(".js-navbar-toggler").on("click",function(){e(".js-animated-menu-icon").toggleClass("open")}),i.mouseenter(function(t){let s=e(this);s.hasClass("active")||function(t,s,o){s=s||!1,o=o||!1;let i=t.data("post"),l=e(".js-sidebar-menu-content[data-post='"+i+"']");l.hasClass("show")?s||(a.find(".active").removeClass("active"),l.removeClass("show"),n.removeClass("open")):o||(n.addClass("open"),a.find(".active").removeClass("active"),t.addClass("active"),r.removeClass("show"),l.addClass("show"))}(s,!0)}),e(document).on("mouseleave",".js-sidebar-menu",function(t){let s=e(this);a.find(".active").removeClass("active"),r.removeClass("show"),s.removeClass("open")}),e("body").on("click touchstart",function(t){e(".js-sidebar-menu").hasClass("open")&&(e(t.target).hasClass("js-sidebar-menu")||e(t.target).hasClass("js-menu-item")||e(".js-sidebar-menu").removeClass("open"))}),e(".js-open-mobile-submenu").click(function(t){let s=e(this);e(t.target).closest(".js-mobile-submenu").length||((s.hasClass("open-submenu")||s.hasClass("no-sub-items"))&&(location.href=e(this).find("a:first").attr("href")),t.preventDefault(),e(".open-submenu").removeClass("open-submenu"),e(".js-mobile-submenu.open").removeClass("open").slideUp(),s.addClass("open-submenu"),s.parent().find(e(".js-mobile-submenu")).addClass("open").slideDown())}),e(window).resize(function(){window.matchMedia("(max-width: 991px)").matches&&n.removeClass("open"),c=window.matchMedia("(max-width: 575px)").matches?15:30,t=e(".home-topic").first().height(),o=e(".red-ribbon").first().height(),e(".red-ribbon").css("height",o)}),C(),e(document).scroll(function(){C()}),e(".js-redirect").click(function(t){t.preventDefault(),location.href=e(this).find("a:first").attr("href")}),e(".js-inline-svg").each(function(){let t=e(this),s=t.attr("id"),o=t.attr("class"),i=t.attr("src");e.get(i,function(i){let n=e(i).find("svg");void 0!==s&&(n=n.attr("id",s)),void 0!==o&&(n=n.attr("class",o+" replaced-svg")),!(n=n.removeAttr("xmlns:a")).attr("viewBox")&&n.attr("height")&&n.attr("width")&&n.attr("viewBox","0 0 "+n.attr("height")+" "+n.attr("width")),t.replaceWith(n)},"xml")}),window.matchMedia("(min-width: 767px)").matches&&e(".js-parallax").mouseenter(function(){e(this).parent().find(".js-progress-circle").addClass("rotate")}).mouseleave(function(){e(this).parent().find(".js-progress-circle").removeClass("rotate")}),e(".js-img-parallax").each(function(){var t=e(this);e(window).scroll(function(){!function(){if(t.offset().top<e(window).scrollTop()){var s=(e(window).scrollTop()-t.offset().top)/2+"px";t.find("img").css("top",s)}else t.find("img").css("top","0")}()})}),document.addEventListener("wpcf7submit",function(t){e("html, body").animate({scrollTop:e(".wpcf7-form").offset().top},1e3)},!1),e(".js-file").change(function(){e(this)[0].files[0].name;let t=e(".js-file-label"),s=e(".js-upload-limit");e(this)[0].files[0].size>=8e6?(s.addClass("upload"),t.text("Datei ist zu groß").addClass("upload")):s.removeClass("upload")});var k=null,S=[];function T(t){var s=t.find(".js-marker");if(k=L.map(t[0],{minZoom:0,maxZoom:18,zoomSnap:.1,zoomDelta:.5,scrollWheelZoom:!1,touchZoom:!0,dragging:!L.Browser.mobile,fullscreenControl:{pseudoFullscreen:!1}}),L.tileLayer("https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",{attribution:'<a href="https://wikimediafoundation.org/wiki/Maps_Terms_of_Use">Wikimedia</a>'}).addTo(k),k.markers=[],e.each(s,function(t,s){!function(t,s){var o=L.icon({iconUrl:"/wp-content/themes/wp_first/img/marker-"+t.attr("data-color")+".svg",iconSize:[32,32],iconAnchor:[17,31],popupAnchor:[0,-17]}),i=L.marker([t.attr("data-lat"),t.attr("data-lng")],{icon:o}).addTo(s);if(e.trim(t.find(".js-info").html())){var n='<div class="map-property clearfix"><p>'+t.find(".js-info").html()+"</p></div>";i.bindPopup(n)}S.push([t.attr("data-lat"),t.attr("data-lng")]),s.markers.push(i)}(jQuery(this),k)}),k.setView([0,0],4),t.data("lines"))L.polyline(S,{color:"#AF3802"}).addTo(k);F(k),k.on("resize",function(){F(k)}),s.remove()}function F(e){if(1==e.markers.length)e.setView(e.markers[0].getLatLng(),12);else{var t=new L.featureGroup(e.markers);e.fitBounds(t.getBounds().pad(.2))}}if(e(".js-map").each(function(){T(e(this))}),e(".js-speech-text").length)if("speechSynthesis"in window){m=window.speechSynthesis,f=new SpeechSynthesisUtterance;let t=e(".js-speech-text").text(),s=!1;h.show(),h.on("click",function(){if(d)window.speechSynthesis.pause(),u=!0,d=!1;else if(d=!0,u&&!p)u=!1,m.resume();else{if(p=!1,m=window.speechSynthesis,f=new SpeechSynthesisUtterance,!s){let e=new SpeechSynthesisUtterance;e.text=" ",window.speechSynthesis.speak(e),s=!0}let o=(t=e(".js-speech-text").text()).split(".");f.rate=.9,f.pitch=.75,f.text=o,console.log(o),f.onend=function(e){console.log("Der Text wurde vorgelesen."),window.speechSynthesis.cancel(),d=!1,p=!0;let t=h.find("img"),s=t.attr("src");t.attr("src",t.data("change")),t.data("change",s)},m.speak(f)}let o=h.find("img"),i=o.attr("src");o.attr("src",o.data("change")),o.data("change",i)})}else h.hide();e(window).load(function(){e(".js-fill-color").each(function(){let t=e(this),s=w.getColor(t.find(".js-get-img-color")[0]);t.css("background-color","rgba("+s+", .6)"),t.closest(".js-fill-border").css("border-color","rgba("+s+", .6)"),t.closest(".js-transcript").find(".js-fill-border").css("border-color","rgba("+s+", .6)")})})})}(jQuery);